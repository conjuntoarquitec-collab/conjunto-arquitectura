<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Conjunto | Selecciona tu paquete</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#121a24;
      --stroke:#203044;
      --stroke2:#2a415b;
      --txt:#eaf0ff;
      --muted:#9fb6d6;
      --blue:#2b7cff;
    }
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--txt)}
    .wrap{max-width:980px;margin:auto;padding:40px 18px}
    .panel{background:var(--card);border:1px solid var(--stroke);border-radius:22px;padding:28px}
    h1{margin:0 0 6px;font-size:34px}
    p{margin:0 0 18px;color:var(--muted);line-height:1.55}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:780px){ .grid{grid-template-columns:1fr;} }
    a.pkg{
      display:block;text-decoration:none;color:inherit;
      background:rgba(10,14,20,.35);
      border:1px solid rgba(42,65,91,.55);
      border-radius:18px;
      padding:18px;
      position:relative;
      transition:transform .12s ease, filter .15s ease, border-color .15s ease, background .15s ease;
    }
    a.pkg:hover{
      filter:brightness(1.08);
      border-color: rgba(43,124,255,.55);
      background: rgba(28,42,58,.55);
      transform: translateY(-1px);
    }
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:#1b2635;border:1px solid var(--stroke2);font-size:12px;color:var(--txt)}
    .title{margin:10px 0 6px;font-size:22px;font-weight:900}
    .desc{margin:0;color:var(--muted);font-size:13px}
    .cta{margin-top:14px;display:inline-block;background:var(--blue);color:#08121f;font-weight:900;padding:10px 14px;border-radius:12px}
    .foot{margin-top:16px;color:var(--muted);font-size:12px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .dot{opacity:.7}
    .vis{font-variant-numeric:tabular-nums}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <span class="badge">Revit 2023/2024/2025/2026 â€¢ Windows</span>
      <h1>Conjunto</h1>
      <p>Elige quÃ© paquete quieres abrir. (Dos puertas: una te da arquitecturaâ€¦ la otra tambiÃ©n, pero con fierros ðŸ˜„)</p>

      <div class="grid">
        <a class="pkg" href="./arquitectura.html">
          <div class="title">1) Conjunto Arquitectura</div>
          <p class="desc">Acabados, metrados, renombrados, exportaciÃ³n, encofrados, etc.</p>
          <span class="cta">Abrir</span>
        </a>

        <a class="pkg" href="./estructura.html">
          <div class="title">2) Conjunto Estructura</div>
          <p class="desc">Aceros, estribos, zapatas, vigas/columnas, y todo el arsenal estructural.</p>
          <span class="cta">Abrir</span>
        </a>
      </div>

      <div class="foot">
        <span>Â© <span id="y"></span> Conjunto</span>
        <span class="dot">â€¢</span>
        <span class="vis">Visitas: <b id="visitas">â€”</b></span>
      </div>
    </div>
  </div>

  <script>
    // AÃ±o
    document.getElementById("y").textContent = new Date().getFullYear();

    // ===== CONTADOR GLOBAL (GitHub Pages no tiene BD, por eso usamos un contador externo) =====
    // 1) Cambia esto por algo Ãºnico tuyo (sin espacios):
    const NAMESPACE = "conjuntoarquitec-collab";   // <-- CAMBIA AQUÃ si quieres
    const KEY = "conjunto-index-visitas";

    const el = document.getElementById("visitas");

    // Evita sumar 100 veces si el mismo usuario refresca (1 vez por dÃ­a por navegador)
    const today = new Date().toISOString().slice(0,10); // YYYY-MM-DD
    const localFlag = `counted:${NAMESPACE}:${KEY}:${today}`;

    async function fetchJSON(url){
      const r = await fetch(url, { cache: "no-store" });
      if(!r.ok) throw new Error("HTTP " + r.status);
      return await r.json();
    }

    async function updateCounter(){
      try{
        // Si ya contÃ³ hoy en este navegador -> solo leer (GET)
        if (localStorage.getItem(localFlag) === "1"){
          const data = await fetchJSON(`https://api.countapi.xyz/get/${encodeURIComponent(NAMESPACE)}/${encodeURIComponent(KEY)}`);
          el.textContent = (data && typeof data.value === "number") ? data.value : "â€”";
          return;
        }

        // Si NO contÃ³ hoy -> sumar (HIT)
        const data = await fetchJSON(`https://api.countapi.xyz/hit/${encodeURIComponent(NAMESPACE)}/${encodeURIComponent(KEY)}`);
        if (data && typeof data.value === "number"){
          el.textContent = data.value;
          localStorage.setItem(localFlag, "1");
        }else{
          el.textContent = "â€”";
        }
      }catch(err){
        // Si algo bloquea el fetch (extensiÃ³n, DNS, etc.)
        el.textContent = "â€”";
        console.warn("Contador no disponible:", err);
      }
    }

    updateCounter();
  </script>
</body>
</html>
